version: 1

defaults:
  region: ap-northeast-1

targets:
  profiles: [] # 空なら ~/.aws/config から自動取得
  exclude:
    - SAMPLE_PROFILE

vars:
  defaults:
    SYSTEM: unknown
    ENV: unknown
    BUCKET_NAME: s3-${SYSTEM}-${ENV}-necro-artifact

  profiles:
    XXX_PRD:
      SYSTEM: xxx
      ENV: prd

cmd:
  - name: necro-artifact-s3bucket-create
    run:
      [
        "s3api",
        "create-bucket",
        "--bucket",
        "${BUCKET_NAME}",
        "--create-bucket-configuration",
        "LocationConstraint=${REGION}",
      ]

  - name: necro-artifact-s3bucket-check
    run:
      [
        "s3api",
        "head-bucket",
        "--bucket",
        "${BUCKET_NAME}",
      ]
